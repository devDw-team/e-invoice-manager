# 📄 **[1-4] 청구서 양식 관리 – 통합 기능명세서**

* * *

## ✅ A. 기능 요약

| 기능 구분 | 설명 |
| --- | --- |
| 목록 조회 | `청구서 생성 여부: 사용`인 사업자 양식만 조회 |
| 검색 필터 | 다중 발송 항목 체크, 사업자명/사업자번호/대표자 기준 검색 |
| 신규 등록 | 사업자 선택 후 항목 선택 및 입력 |
| 수정 | 기존 양식 수정, 항목 상태 변경 |
| 입력 검증 | 필수값 누락 시 Alert, 저장 전 Confirm 제공 |

* * *

## ✅ B. 프론트엔드 기능명세서

### 1. 📃 목록 화면 (`app/vendor-forms/page.tsx`)

#### 🔍 검색 조건

| 항목 | 유형 | 기본값 |
| --- | --- | --- |
| 체크박스 그룹 | 청구서 발송 항목(다중 선택) | 전체 미선택 가능 |
| 셀렉박스 | 검색 기준(`사업자명`, `사업자번호`, `대표자`) | `사업자명` |
| 검색어 입력 | 선택된 기준에 따른 검색 키워드 입력 | - |

* 다중 선택된 청구서 발송 항목 중 **하나 이상 포함된 양식** 결과 출력 (`OR` 조건)
* 목록은 `청구서 생성 여부가 사용`인 사업자만 대상

* * *

#### 🧾 출력 리스트 필드

| 필드 | 설명 |
| --- | --- |
| No | 최신 등록순 (내림차순) |
| {사업자명} 청구서 | 클릭 시 상세 편집 페이지 이동 |
| 사업자번호 | 사업자 등록번호 |
| 대표자 | 대표자 이름 |
| 설정 항목 | 각 항목 상태값 O/X로 표시 |
| 등록자 | 관리자 ID |
| 등록일 | `YYYY.MM.DD HH:MM` |
| 수정자 | 관리자 ID |
| 수정일 | `YYYY.MM.DD HH:MM` |

#### 📦 페이징 및 보기 수 설정

* 기본: 1페이지당 50건
* 옵션: 10 / 50 / 100건 보기 선택
* 검색결과 총 건수 표시

* * *

### 2. ✏️ 등록/수정 화면 (`/vendor-forms/new`, `/vendor-forms/[id]/edit.tsx`)

#### 📌 항목 구성

##### 1) 공급받는자 정보 (사업자 정보)

| 필드 | 설명 |
| --- | --- |
| 사업자 검색 | 사업자 목록 팝업 열기 (`modal`) |
| 적용된 사업자 정보 | 사업자명, 사업자번호, 대표자, 업태, 종목 |
| 편집 가능 여부 | 모두 비활성화 (배경 회색 처리) |

##### 2) 공급자 정보 항목

| 항목 | 설명 |
| --- | --- |
| 인감 정보 | 체크박스, 기본 선택 |
| 고객센터 안내 정보 | 체크박스 + 텍스트 입력, 기본 선택 + 디폴트 문구 제공 |
| 필드 내용 | 콜센터 번호, 홈페이지 등 (고정값 입력 필드) |

##### 3) 결제/선납금 정보

| 항목 | 설명 |
| --- | --- |
| 결제 정보, 선납금 정보 | 체크박스, 기본 선택 |
| 결제 안내 정보 | 체크박스 + 텍스트 입력, 300자 이내 제한, 줄바꿈 가능 |

##### 4) 청구대금 상세 항목

| 항목 | 기본 선택 여부 |
| --- | --- |
| 주문번호, 제품군, 모델명, 계약일, 의무사용기간, 약정기간, 공급가액, 부가세, 렌탈료, 설치처 주소, 멤버십, 연체이자 | ✅ 디폴트 선택 |
| 비고, 바코드 번호, A/S 대금, 소모품 교체비, 위약금, 관리지국명, 연락처 | ❌ 디폴트 미선택 |

* * *

#### 🚨 유효성 체크

| 항목 | 메시지 |
| --- | --- |
| 사업자 미선택 | "'사업자 찾기'를 통해 사업자 정보를 입력해주세요." |
| 필수항목 모두 입력 시 | 저장 전 컨펌: "작성한 내용으로 저장하시겠습니까?" |

* * *

#### 📂 버튼 액션

| 버튼 | 설명 |
| --- | --- |
| 목록 | AlertDialog |
| "목록으로 이동하시겠습니까? 작성(수정) 중인 내용은 반영되지 않습니다." | |
| → [취소] / [나가기] | |
| 저장 | |

* 유효성 미통과 시 Alert 메시지
* 통과 시 Confirm → 저장 → 토스트 메시지 → 목록 이동

* * *

### 3. 🧪 테스트 항목

* 사업자 선택 후 정보 표시 및 수정 불가 처리
* 체크박스 항목 변경 시 상태 반영
* 고객센터/결제 안내 텍스트 필드에 기본값 자동입력 여부
* 저장 유효성 체크 및 컨펌 다이얼로그 노출
* 목록 → AlertDialog 정상 작동
* 다중 발송 항목 체크 → OR 조건 필터링 확인

* * *

## ✅ C. 백엔드 기능명세서

### 1. 📡 청구서 양식 목록 조회 API

| 경로 | `/api/vendor-forms` |
| --- | --- |
| Method | `GET` |
| 설명 | 등록된 청구서 양식 리스트 조회 (필터, 페이징 포함) |

#### 📥 Query Params

| 파라미터 | 설명 |
| --- | --- |
| `invoiceItems[]` | 선택된 발송 항목들 (다중 값) |
| `searchField` | `name` / `code` / `ceo` |
| `searchValue` | 키워드 |
| `page` | 페이지 번호 |
| `limit` | 페이지당 수 (10/50/100) |

#### 📤 Response 예시

```json
{
  "data": [
    {
      "id": 1,
      "vendorName": "코웨이",
      "vendorCode": "1234567890",
      "ceo": "홍길동",
      "invoiceItems": {
        "paymentInfo": true,
        "membership": false,
        "barcode": true
      },
      "createdBy": "admin01",
      "createdAt": "2024.03.01 13:11",
      "updatedBy": "admin02",
      "updatedAt": "2024.03.05 11:50"
    }
  ],
  "total": 34,
  "page": 1,
  "limit": 50
}
```

* * *

### 2. 📡 청구서 양식 등록/수정 API

| 경로 | `/api/vendor-forms` |
| --- | --- |
| Method | `POST` / `PUT` |

#### 📥 Request Body

```json
{
  "vendorId": 123,
  "invoiceItems": {
    "paymentInfo": true,
    "barcode": false,
    ...
  },
  "callCenterInfo": "1588-5200, coway.com",
  "paymentDescription": "고객이 제공한 결제정보에 의해...",
  "modifier": "admin01"
}
```

* * *

### 3. 🗃 DB 테이블 예시: `vendor_forms`

| 필드 | 타입 | 설명 |
| --- | --- | --- |
| `id` | number | PK |
| `vendor_id` | number | 사업자 FK |
| `invoice_items` | json | 선택 항목 boolean map |
| `callcenter_info` | text | 고객센터 안내 |
| `payment_description` | text | 결제 안내 문구 |
| `created_by` | string | 등록자 |
| `created_at` | datetime | 등록일 |
| `updated_by` | string | 수정자 |
| `updated_at` | datetime | 수정일 | 