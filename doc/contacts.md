# 📄 **[1-3] 담당자 관리 – 통합 기능명세서**

* * *

## ✅ A. 기능 요약

| 기능 구분 | 설명 |
| --- | --- |
| 목록 조회 | 등록된 담당자 리스트를 조건 필터로 검색 |
| 신규 등록 | 사업자 선택 → 담당자 정보 입력 후 저장 |
| 정보 수정 | 기존 담당자 정보 편집 |
| 일괄 처리 | 사용/미사용 상태 변경 (체크박스 기반) |

* * *

## ✅ B. 프론트엔드 기능명세서

### 1. 📃 목록 조회 화면 (`app/vendors/contacts/page.tsx`)

#### 🔍 검색 조건

| 항목 | 유형 | 기본값 |
| --- | --- | --- |
| 셀렉박스 1 | 사용여부 (`전체`, `사용`, `미사용`) | 전체 |
| 셀렉박스 2 | 검색 기준 (`사업자명`, `사업자번호`, `지점명`, `이메일`) | 사업자명 |
| 검색 입력창 | 선택된 기준에 따라 검색어 입력 | - |

#### 🧾 출력 리스트 필드

| 필드 | 설명 |
| --- | --- |
| 체크박스 | 전체 선택 / 개별 선택 |
| No | 최근 등록일 순 정렬 (내림차순) |
| 사업자명 | 사업자 정보 |
| 사업자번호 | 사업자 등록번호 |
| 지점명 | 해당 지점 이름 |
| 이메일 | 담당자 이메일 |
| 사용여부 | 사용 / 미사용 |
| 등록자 | 최초 등록한 관리자 ID |
| 등록일 | 최초 등록일 (`YYYY.MM.DD HH:MM`) |
| 수정자 | 수정한 관리자 ID |
| 등록/수정일 | 최근 수정일 (`YYYY.MM.DD HH:MM`) |

#### 📦 페이징 및 보기 수 설정

* 기본: 1페이지당 50건 노출
    
* 보기 수 조절 옵션: 10개 / 50개 / 100개
    
* 검색 결과 총 개수 표시: `총 154건`
    

#### ✏️ 항목 클릭

* 담당자 이름 클릭 시: `/vendors/contacts/[id]/edit` 페이지로 이동
    

* * *

#### ⚙️ 일괄 상태 변경 기능

* 체크된 항목 대상 사용 여부 일괄 변경 (`사용`, `미사용`)
    
* 드롭다운 + 적용 버튼 구성
    
* 반영 후 토스트 메시지: "3건의 상태가 변경되었습니다"
    

* * *

### 2. ✏️ 등록/수정 화면 (`/contacts/new`, `/contacts/[id]/edit.tsx`)

#### 📌 입력 영역 구성

| 필드 | UI 요소 | 제약조건 |
| --- | --- | --- |
| 사업자 선택 | `Button` + 팝업 | 필수 입력, "사업자 찾기" 버튼 클릭 시 팝업 오픈 |
| 사업자명 / 사업자번호 | Read-only 필드 | 수정 불가 |
| 지점명 | `Input` | 선택 입력, 30자 제한 |
| 이메일 | `Input` | 필수 입력, 30자 제한 |
| 사용여부 | `Radio Group` | `사용` (디폴트), `미사용` |

#### 🔍 사업자 찾기 팝업

| 항목 | 설명 |
| --- | --- |
| 팝업 제목 | "사업자 찾기" |
| 검색 조건 | 사업자명 또는 사업자번호로 검색 |
| 출력 필드 | - 사업자번호<br>- 사업자명<br>- 대표자명 |
| 동작 | - 항목 클릭 시 선택한 사업자 정보가 등록/수정 화면에 자동 입력<br>- 선택 후 팝업 자동 닫힘 |
| 버튼 | [닫기] |

#### 🚨 유효성 체크 메시지

| 조건 | Alert 메시지 |
| --- | --- |
| 사업자 미선택 | `'사업자 찾기'를 통해 사업자 정보를 입력해주세요.` |
| 이메일 미입력 | `이메일을 입력해주세요.` |
| 지점명 미입력 (선택 입력 시) | `지점명을 입력해주세요.` (조건부) |

* * *

#### 📂 버튼 액션

| 버튼 | 설명 |
| --- | --- |
| 목록 | AlertDialog: |
| "목록으로 이동하시겠습니까? 작성(수정) 중인 내용은 반영되지 않습니다." |  |
| → [취소] / [나가기] |  |
| 저장 |  |

* 유효성 실패 시 Alert 메시지 노출
    
* 유효성 통과 시 컨펌창  
    "작성한 내용으로 저장하시겠습니까?" → [취소] / [저장]
    
* 저장 후 목록 이동 + 토스트 알림 |
    

* * *

### 3. 🧪 테스트 항목

*  진입 시 전체 리스트 자동 조회
    
*  검색 조건(AND) 필터링 정확성
    
*  담당자명 클릭 → 수정 페이지 진입
    
*  목록 → AlertDialog 정상 작동
    
*  등록 시 사업자 팝업 + 적용 처리 여부
    
*  저장 유효성 체크 → Alert 및 저장 로직 정상 작동
    
*  일괄 상태 변경 후 UI 및 DB 반영 확인
    

* * *

## ✅ C. 백엔드 기능명세서

### 1. 📡 담당자 목록 조회 API

| 항목 | 설명 |
| --- | --- |
| 경로 | `/api/vendor-contacts` |
| Method | `GET` |
| 기능 | 조건 필터 + 페이징 지원 목록 조회 |

#### 📥 Query Params

| 파라미터 | 설명 |
| --- | --- |
| `status` | 사용여부: `all` / `used` / `unused` |
| `searchField` | 검색 기준: `name`, `code`, `branch`, `email` |
| `searchValue` | 검색어 |
| `page` | 페이지 번호 |
| `limit` | 한 페이지당 개수 |

#### 📤 Response 예시

```json
{
  "data": [
    {
      "id": 1,
      "vendorName": "코웨이",
      "vendorCode": "1234567890",
      "branch": "강남지점",
      "email": "coway@example.com",
      "status": "사용",
      "createdBy": "admin01",
      "createdAt": "2024.03.05 10:11",
      "updatedBy": "admin02",
      "updatedAt": "2024.03.11 14:20"
    }
  ],
  "total": 150,
  "page": 1,
  "limit": 50
}
```

* * *

### 2. 📡 담당자 등록/수정 API

| 경로 | `/api/vendor-contacts` | | Method | `POST` (등록), `PUT` (수정) |

#### 📥 Request Body

```json
{
  "id": 1, // 수정 시만 포함
  "vendorId": 123,
  "branch": "강남지점",
  "email": "test@example.com",
  "status": "사용",
  "modifier": "admin01"
}
```

#### 📤 Response

```json
{
  "message": "저장이 완료되었습니다.",
  "contactId": 1
}
```

* * *

### 3. 📡 사용여부 일괄 변경 API

| 경로 | `/api/vendor-contacts/status` | | Method | `PUT` |

#### 📥 Request Body

```json
{
  "contactIds": [1, 2, 3],
  "status": "미사용"
}
```

#### 📤 Response

```json
{
  "updatedCount": 3
}
```

* * *

### 4. 📡 사업자 검색 API

| 항목 | 설명 |
| --- | --- |
| 경로 | `/api/vendors/search` |
| Method | `GET` |
| 기능 | 사업자명 또는 사업자번호로 사업자 정보 검색 |

#### 📥 Query Params

| 파라미터 | 설명 |
| --- | --- |
| `searchField` | 검색 기준: `name` (사업자명) / `code` (사업자번호) |
| `searchValue` | 검색어 |
| `page` | 페이지 번호 |
| `limit` | 한 페이지당 개수 (기본값: 10) |

#### 📤 Response 예시

```json
{
  "data": [
    {
      "id": 1,
      "vendorCode": "1234567890",
      "vendorName": "코웨이",
      "representativeName": "홍길동",
      "status": "사용"
    }
  ],
  "total": 15,
  "page": 1,
  "limit": 10
}
```

* * *

## 🗃 DB 테이블: `vendor_contacts`

| 컬럼 | 타입 | 설명 |
| --- | --- | --- |
| `id` | number | PK |
| `vendor_id` | number | 사업자 ID (FK) |
| `branch` | string | 지점명 |
| `email` | string | 이메일 |
| `status` | enum | `사용` / `미사용` |
| `created_by` | string | 등록자 |
| `created_at` | datetime | 등록일 |
| `updated_by` | string | 수정자 |
| `updated_at` | datetime | 수정일 | 